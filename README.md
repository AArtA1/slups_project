# Проект по Введению в случайные процессы 

## Авторы:
* Асланян Артак Арманович
* Блинов Савва Георгиевич
* Аристархов Данила Константинович
* Есенин Александр Сергеевич

Проект для калибровки финансовых моделей и оценки справедливой стоимости Range Accrual дериватива на основе симуляций Монте-Карло.

## Описание

Проект выполняет две основные задачи:

1. **Калибровка и симуляция трёх скоррелированных риск-факторов:**
   - Краткосрочная ставка в рублях (RUONIA)
   - Краткосрочная ставка в долларах США (SOFR)
   - Обменный курс USD/RUB в логнормальной модели (геометрическое броуновское движение)

2. **Оценка справедливой стоимости Range Accrual дериватива** на основе симуляций курса USD/RUB и рублевой ставки.

## Подходы к моделированию

Проект реализует **два подхода** к моделированию процентных ставок:

### 1. Модель CIR (Кокса–Ингерсолла–Росса)
- Реализована в `src/project.ipynb` и `src/project.py`
- Классическая модель для положительных ставок
- Волатильность зависит от уровня ставки: $\sigma\sqrt{r_t}$

### 2. Модель Hull-White (Extended Vasicek)
- Реализована в `src/hull_white.ipynb`
- Подходит для околонулевых и отрицательных ставок
- Постоянная волатильность $\sigma$
- Аналитическая трактуемость для оценки деривативов

## Структура проекта

```
SLUP_PROJECT/
├── data/                          # Исторические данные
│   ├── RC_F11_01_2010_T10_12_2021.csv  # Данные RUONIA
│   ├── SOFR.csv                   # Данные SOFR
│   └── usdrub_data.csv            # Данные курса USD/RUB
├── src/
│   ├── model.py                   # Основные функции моделирования
│   ├── project.ipynb              # Ноутбук с подходом CIR
│   └── hull_white.ipynb           # Ноутбук с подходом Hull-White
├── pyproject.toml                 # Конфигурация проекта и зависимости
└── README.md                      # Документация проекта
```

## Требования

- Python >= 3.13
- Зависимости указаны в `pyproject.toml`

## Установка

1. Клонируйте репозиторий или скачайте проект.

2. Установите зависимости. Если используется `uv`:
   ```bash
   uv sync
   ```

   Или с помощью `pip`:
   ```bash
   pip install -e .
   ```

## Основные функции

### Модуль `model.py`

- `plot_history(series, title, ylabel)` — построение графиков исторических рядов
- `ols_cir(data, dt)` — калибровка параметров CIR-модели методом наименьших квадратов
- `estimate_fx_vol_from_series(S_series, dt_years)` — оценка волатильности курса по лог-доходностям
- `compute_corr_matrix(dr_rub, dr_usd, log_ret_fx)` — построение корреляционной матрицы
- `simulate_market_paths(...)` — симуляция траекторий трёх риск-факторов
- `price_range_accrual(...)` — оценка справедливой стоимости Range Accrual дериватива

## Использование

### Подход CIR

1. Откройте ноутбук `src/project.ipynb` или скрипт `src/project.py` в Jupyter.

2. Убедитесь, что данные находятся в директории `data/`.

3. Запустите ячейки ноутбука последовательно:
   - Калибровка CIR для рублевой ставки (RUONIA)
   - Калибровка CIR для долларовой ставки (SOFR)
   - Калибровка волатильности курса USD/RUB
   - Задание параметров сделки и рыночных условий
   - Построение корреляционной матрицы
   - Настройка параметров Монте-Карло симуляции
   - Симуляция и прайсинг Range Accrual

### Подход Hull-White

1. Откройте ноутбук `src/hull_white.ipynb` в Jupyter.

2. Убедитесь, что данные находятся в директории `data/`.

3. Запустите ячейки ноутбука последовательно:
   - Загрузка данных (RUONIA, SOFR, USD/RUB)
   - Калибровка Hull-White для рублевой ставки (RUONIA)
   - Калибровка Hull-White для долларовой ставки (SOFR)
   - Калибровка волатильности курса USD/RUB
   - Построение корреляционной матрицы
   - Симуляция и прайсинг Range Accrual с использованием Hull-White

## Параметры моделей

### CIR-модель для ставок

Модель описывается уравнением:
\[
dr_t = \kappa(\theta - r_t)dt + \sigma\sqrt{r_t}dW_t
\]

Параметры:
- `kappa` — скорость возврата к долгосрочному уровню
- `theta` — долгосрочное среднее значение ставки
- `sigma` — волатильность ставки

### Hull-White модель для ставок

Модель описывается уравнением:
\[
dr_t = a(\mu - r_t)dt + \sigma dW_t
\]

Параметры:
- `a` — скорость возврата к среднему (Mean Reversion Speed)
- `mu` — долгосрочный средний уровень ставки
- `sigma` — абсолютная волатильность (постоянная)

**Преимущества Hull-White:**
- Работает с околонулевыми и отрицательными ставками
- Постоянная волатильность упрощает калибровку (не требует взвешивания)
- Аналитические решения для цен облигаций и опционов

### Логнормальная модель для курса

\[
d\ln S_t = \left(\mu - \frac{1}{2}\sigma_{FX}^2\right)dt + \sigma_{FX} dW_t^{FX}
\]

Параметр:
- `sigma_fx` — годовая волатильность лог-доходностей

## Range Accrual

Range Accrual — дериватив, выплата по которому зависит от доли времени, в течение которого курс USD/RUB находился в заданном диапазоне `[Lower_Barrier, Upper_Barrier]`.

Справедливая стоимость оценивается методом Монте-Карло с дисконтированием по рублевой ставке.

## Данные

Проект использует исторические данные за период 2019–2021 для калибровки моделей:
- **RUONIA** — краткосрочная ставка в рублях
- **SOFR** — краткосрочная ставка в долларах США
- **USD/RUB** — обменный курс

## Зависимости

- `numpy >= 2.3.5` — численные вычисления
- `pandas >= 2.3.3` — работа с данными
- `matplotlib >= 3.10.7` — визуализация
- `scikit-learn >= 1.7.2` — линейная регрессия для калибровки
- `statsmodels >= 0.14.5` — статистические модели
- `seaborn >= 0.13.2` — расширенная визуализация
- `ipykernel >= 7.1.0` — поддержка Jupyter
