# Проект по Введению в случайные процессы 

## Авторы:
* Асланян Артак Арманович  
* Блинов Савва Георгиевич  
* Аристархов Данила Константинович  
* Есенин Александр Сергеевич  

Проект для калибровки финансовых моделей и оценки справедливой стоимости Range Accrual дериватива на основе симуляций Монте-Карло.

## Описание

Проект выполняет две основные задачи:

1. **Калибровка и симуляция трёх скоррелированных риск-факторов:**
   - Краткосрочная ставка в рублях (RUONIA)
   - Краткосрочная ставка в долларах США (SOFR)
   - Обменный курс USD/RUB (логнормальная модель)

2. **Оценка справедливой стоимости Range Accrual дериватива** методом Монте-Карло.

## Подходы к моделированию

### 1. Модель CIR (Кокса–Ингерсолла–Росса)

Классическая модель положительных ставок, волатильность зависит от уровня ставки.

```math
dr_t = \kappa(\theta - r_t)\, dt + \sigma\sqrt{r_t}\, dW_t
```

Параметры:
- `kappa` — скорость возврата к среднему  
- `theta` — долгосрочный уровень  
- `sigma` — волатильность  

### 2. Модель Hull-White (Extended Vasicek)

Подходит для нулевых/отрицательных ставок, имеет постоянную волатильность.

```math
dr_t = a(\mu - r_t)\, dt + \sigma\, dW_t
```

Параметры:
- `a` — скорость возврата  
- `mu` — средний уровень  
- `sigma` — абсолютная волатильность  

**Преимущества Hull-White:**
- работает при околонулевых ставках  
- простая калибровка  
- аналитические формулы для облигаций и деривативов  

### Логнормальная модель для курса USD/RUB

```math
d\ln S_t = \left(\mu - \frac{1}{2}\sigma_{FX}^2\right)dt 
+ \sigma_{FX}\, dW_t^{FX}
```

Параметр:
- `sigma_fx` — годовая волатильность лог-доходностей  

---

## Структура проекта

```
SLUP_PROJECT/
├── data/
│   ├── RC_F11_01_2010_T10_12_2021.csv
│   ├── SOFR.csv
│   └── usdrub_data.csv
├── src/
│   ├── model.py
│   ├── project.ipynb
│   └── hull_white.ipynb
├── pyproject.toml
└── README.md
```

## Требования

- Python ≥ 3.13  
- Все зависимости перечислены в `pyproject.toml`

## Установка

```bash
uv sync
```

или

```bash
pip install -e .
```

---

## Основные функции (`model.py`)

- `plot_history(series, title, ylabel)` — графики исторических данных  
- `ols_cir(data, dt)` — МНК-калибровка CIR  
- `estimate_fx_vol_from_series(S_series, dt_years)` — оценка FX-волатильности  
- `compute_corr_matrix(dr_rub, dr_usd, log_ret_fx)` — корреляционная матрица  
- `simulate_market_paths(...)` — Монте-Карло симуляции  
- `price_range_accrual(...)` — прайсинг Range Accrual  

---

## Использование

### Подход CIR

1. Открыть `src/project.ipynb`  
2. Проверить наличие данных в `data/`  
3. Последовательно выполнить:
   - Калибровка CIR для RUONIA  
   - Калибровка CIR для SOFR  
   - Оценка FX-волатильности  
   - Формирование корреляционной матрицы  
   - Настройка параметров Монте-Карло  
   - Прайсинг Range Accrual  

### Подход Hull-White

То же самое, но с использованием `hull_white.ipynb`.

---

## Параметры моделей

### CIR

```math
dr_t = \kappa(\theta - r_t)\, dt + \sigma\sqrt{r_t}\, dW_t
```

### Hull-White

```math
dr_t = a(\mu - r_t)\, dt + \sigma\, dW_t
```

### Логнормальная модель курса

```math
d\ln S_t = \left(\mu - \frac{1}{2}\sigma_{FX}^2\right)\!dt 
+ \sigma_{FX}\, dW_t^{FX}
```

---

## Range Accrual

Дериватив, выплата которого зависит от доли времени, когда курс USD/RUB находится в диапазоне `[Lower_Barrier, Upper_Barrier]`.

Цена оценивается методом Монте-Карло с дисконтированием рублевой ставкой.

---

## Данные

Используем исторические данные 2019–2021:
- **RUONIA**
- **SOFR**
- **USD/RUB**

---

## Зависимости

- `numpy >= 2.3.5`  
- `pandas >= 2.3.3`  
- `matplotlib >= 3.10.7`  
- `scikit-learn >= 1.7.2`  
- `statsmodels >= 0.14.5`  
- `seaborn >= 0.13.2`  
- `ipykernel >= 7.1.0`  

